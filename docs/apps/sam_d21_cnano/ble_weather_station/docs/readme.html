<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>BLE based Weather Station and Motion Sensor Application - Microchip MPLAB Harmony Reference Applications help</title> <link rel="shortcut icon" href="../../../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../../../assets/css/just-the-docs.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "UA-2724382-16"); </script> <script type="text/javascript" src="../../../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>BLE based Weather Station and Motion Sensor Application | Microchip MPLAB Harmony Reference Applications help</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="BLE based Weather Station and Motion Sensor Application" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 Reference Applications package" /> <meta property="og:description" content="Harmony 3 Reference Applications package" /> <link rel="canonical" href="../../../../apps/sam_d21_cnano/ble_weather_station/docs/readme.html" /> <meta property="og:url" content="../../../../apps/sam_d21_cnano/ble_weather_station/docs/readme.html" /> <meta property="og:site_name" content="Microchip MPLAB Harmony Reference Applications help" /> <script type="application/ld+json"> {"@type":"WebPage","url":"../../../../apps/sam_d21_cnano/ble_weather_station/docs/readme.html","headline":"BLE based Weather Station and Motion Sensor Application","description":"Harmony 3 Reference Applications package","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="../../../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="../../../../index.html" class="navigation-list-link">Harmony 3 Reference Applications Package</a></li><li class="navigation-list-item active"><a href="../../../../apps/readme.html" class="navigation-list-link">Reference Applications</a><ul class="navigation-list-child-list "><li class="navigation-list-item active"><a href="../../../../apps/sam_d21_cnano/readme.html" class="navigation-list-link">SAM D21 Curiosity Nano Evaluation Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_d21_cnano/samd21n_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_d21_cnano/fitness_tracker/docs/readme.html" class="navigation-list-link">Fitness Tracker</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_d21_cnano/location_sos/docs/readme.html" class="navigation-list-link">Location Tagged SOS</a> </li><li class="navigation-list-item active"> <a href="../../../../apps/sam_d21_cnano/ble_weather_station/docs/readme.html" class="navigation-list-link active">BLE based Weather Station and Motion Sensor Application</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/pic32mz_ef_curiosity_v2/readme.html" class="navigation-list-link">Curiosity PIC32MZ EF 2.0 Development Board</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_curiosity_v2/pic32mzef_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_curiosity_v2/getting_started_ext/docs/readme.html" class="navigation-list-link">Getting Started Extended</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_curiosity_v2/getting_started_middleware/docs/readme.html" class="navigation-list-link">Getting Started Middleware</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_curiosity_v2/msd_multiple_luns/docs/readme.html" class="navigation-list-link">USB MSD with Multiple Drives</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_curiosity_v2/sdcard_player/docs/readme.html" class="navigation-list-link">SD Card Audio Player</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/sam_l10_xpro/readme.html" class="navigation-list-link">SAM L10 Xplained Pro Evaluation Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_l10_xpro/saml10_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_l10_xpro/saml10_low_power/docs/readme.html" class="navigation-list-link">Low Power</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/sam_l21_xpro/readme.html" class="navigation-list-link">SAM L21 Xplained Pro Evaluation Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_l21_xpro/saml21_low_power/docs/readme.html" class="navigation-list-link">Low Power</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/sam_c21_xpro/readme.html" class="navigation-list-link">SAM C21 Xplained Pro evaluation kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_c21_xpro/samc21_low_power/docs/readme.html" class="navigation-list-link">Low Power</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/sam_e70_xult/readme.html" class="navigation-list-link">SAM E70 Xplained Ultra Evaluation Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_e70_xult/same70_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_e70_xult/getting_started_drv/docs/readme.html" class="navigation-list-link">Getting Started with Drivers</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_e70_xult/getting_started_freertos/docs/readme.html" class="navigation-list-link">Getting Started with FreeRTOS</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_e70_xult/qspi_xdmac_read_write/docs/readme.html" class="navigation-list-link">XDMAC with QSPI</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_e70_xult/ftp_bootloader/docs/readme.html" class="navigation-list-link">Ethernet bootloader - File Transfer Protocol</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/sam_e54_xpro/readme.html" class="navigation-list-link">SAM E54 Xplained Pro Evaluation Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_e54_xpro/same54_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li><li class="navigation-list-item "> <a href="../../../../apps/sam_e54_xpro/sleepwalking/docs/readme.html" class="navigation-list-link">SleepWalking</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/sam_d21_xpro/readme.html" class="navigation-list-link">SAM D21 Xplained Pro Evaluation Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_d21_xpro/samd21_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/sam_c21n_xpro/readme.html" class="navigation-list-link">SAM C21N Xplained Pro Evaluation Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/sam_c21n_xpro/samc21n_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/pic32mk_gp_db/readme.html" class="navigation-list-link">PIC32MK General Purpose (GP) Development Board</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/pic32mk_gp_db/pic32mk_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/pic32mx470_curiosity/readme.html" class="navigation-list-link">Curiosity PIC32MX470 Development Board</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/pic32mx470_curiosity/pic32mx470_getting_started/docs/readme.html" class="navigation-list-link">Getting Started</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/pic32mz_ef_sk_meb2/readme.html" class="navigation-list-link">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit + MEB-II</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_sk_meb2/audio_player/docs/readme.html" class="navigation-list-link">SD Card Player/Reader series</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_sk_meb2/audio_player/audio_player_lab1/docs/readme.html" class="navigation-list-link">Audio-Tone using a Lookup Table</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_sk_meb2/audio_player/audio_player_lab2/docs/readme.html" class="navigation-list-link">Audio-Tone Application by reading the tone from a text file stored in an SD card</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_sk_meb2/audio_player/audio_player_lab3/docs/readme.html" class="navigation-list-link">SD Card Reader and Audio-Tone Application by reading the tone from a text file stored in an SD card</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_sk_meb2/audio_player/audio_player_lab4/docs/readme.html" class="navigation-list-link">SD Card Reader .wav Audio player</a> </li><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_sk_meb2/audio_player/audio_player_lab5/docs/readme.html" class="navigation-list-link">SD Card Audio Player/Reader with Aria Graphics</a> </li></ul></li><li class="navigation-list-item "><a href="../../../../apps/pic32mz_ef_sk/readme.html" class="navigation-list-link">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../../../apps/pic32mz_ef_sk/pic32mz_uart_live_update/docs/readme.html" class="navigation-list-link">Live update on PIC32MZ</a> </li></ul></li></ul></li><li class="navigation-list-item"><a href="../../../../release_notes.html" class="navigation-list-link">Release notes</a></li><li class="navigation-list-item"><a href="../../../../mplab_harmony_license.html" class="navigation-list-link">License</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Microchip MPLAB Harmony Reference Applications help" aria-label="Search Microchip MPLAB Harmony Reference Applications help" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="https://support.microchip.com">Obtain Support from Microchip</a></li> </ul> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../../../apps/readme.html">Reference Applications</a></li> <li class="breadcrumb-nav-list-item"><a href="../../../../apps/sam_d21_cnano/readme.html">SAM D21 Curiosity Nano Evaluation Kit</a></li> <li class="breadcrumb-nav-list-item"><span>BLE based Weather Station and Motion Sensor Application</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <p><img src="images/microchip_logo.png" /> <img src="images/microchip_mplab_harmony_logo_small.png" /></p> <h1 id="ble-based-weather-station-and-motion-sensor-application-on-sam-d21-curiosity-nano-and-nano-base-for-click-boards"> <a href="#ble-based-weather-station-and-motion-sensor-application-on-sam-d21-curiosity-nano-and-nano-base-for-click-boards" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> BLE based Weather Station and Motion Sensor Application on SAM D21 Curiosity Nano and Nano Base for Click boards </h1> <hr /> <h2 id="description"> <a href="#description" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Description: </h2> <blockquote> <p>The application demonstrates a solution based on Microchip products for environmental or weather industry products. The application demonstrates posting of weather and motion sensor data collected from the various sensors to android mobile application via BLE (Bluetooth Low Energy). The PTH (Pressure, Temperature and Humidity) collected from the Mikro elektronika weather click board and motion sensor data collected from the Mikro elektronika 10DOF Click are posted to the android application via BM71 Bluetooth module.</p> </blockquote> <blockquote> <p>The host microcntroller (SAM D21) is interfaced to the weather click and 10DOF click over the I2C interface and BM71 XPRO over UART.</p> </blockquote> <h2 id="modulestechnology-used"> <a href="#modulestechnology-used" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Modules/Technology Used: </h2> <ul> <li>Peripheral Modules <ul> <li>Timer</li> <li>SERCOM</li> </ul> </li> <li>Driver Modules <ul> <li>BM71 Driver</li> </ul> </li> <li>STDIO Library</li> </ul> <h2 id="hardware-used"> <a href="#hardware-used" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Hardware Used: </h2> <ul> <li><a href="https://www.microchip.com/Developmenttools/ProductDetails/DM320119">SAM D21 Curiosity Nano Evaluation Kit</a></li> <li><a href="https://www.microchip.com/Developmenttools/ProductDetails/AC164162">Curiosity Nano Base for click boards</a></li> <li><a href="https://www.mikroe.com/weather-click">WEATHER CLICK</a></li> <li><a href="https://www.mikroe.com/10dof-click">10DOF Click</a></li> <li><a href="https://www.microchip.com/Developmenttools/ProductDetails/DM164146">BM71-XPRO</a></li> </ul> <h2 id="softwaretools-used"> <a href="#softwaretools-used" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Software/Tools Used: </h2> <p><span style="color:blue"> <em>This project has been verified to work with the following versions of software tools:</em></span></p> <ul> <li><a href="https://github.com/Microchip-MPLAB-Harmony/csp/releases/tag/v3.7.1">MPLAB Harmony v3 “csp” repo v3.7.1</a></li> <li><a href="https://github.com/Microchip-MPLAB-Harmony/core/releases/tag/v3.7.1">MPLAB Harmony v3 “core” repo v3.7.1</a></li> <li><a href="https://github.com/Microchip-MPLAB-Harmony/dev_packs/releases/tag/v3.7.0">MPLAB Harmony v3 “dev_packs” repo v3.7.0</a></li> <li><a href="https://github.com/Microchip-MPLAB-Harmony/mhc/releases/tag/v3.4.0">MPLAB Harmony v3 “mhc” repo v3.4.0</a></li> <li><a href="https://github.com/Microchip-MPLAB-Harmony/bt/releases/tag/v3.4.0">MPLAB Harmony v3 “bt” repo v3.4.0</a></li> <li>MPLAB Harmony Configurator Plugin v3.5.0</li> <li><a href="https://www.microchip.com/mplab/mplab-x-ide">MPLAB X IDE v5.40</a></li> <li><a href="https://www.microchip.com/mplab/compilers">MPLAB XC32 Compiler v2.41</a></li> <li><a href="https://play.google.com/store/apps/details?id=com.microchip.bluetooth.data&amp;hl=en">Microchip Bluetooth Data</a></li> </ul> <p><span style="color:blue"> <em>Because Microchip regularly update tools, occasionally issue(s) could be discovered while using the newer versions of the tools. If the project doesn’t seem to work and version incompatibility is suspected, It is recommended to double-check and use the same versions that the project was tested with.</em> </span></p> <h2 id="adding-private-characteristics-to-bm71"> <a href="#adding-private-characteristics-to-bm71" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Adding private characteristics to BM71: </h2> <h4 id="hardware-setup"> <a href="#hardware-setup" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Hardware Setup </h4> <ul> <li>In BM71-XPRO, Change jumper J2 to select USB</li> <li>In BM71-XPRO, Configure DIP switch SW2 with below configurations</li> <li>All DIP switch ON</li> <li>Power the BM71-XPRO from a Host PC through a Type-A male to Micro-B USB cable connected to Micro-B port (J1)</li> <li>Perform reset by pressing switch SW1 on BM71-XPRO and check blue LD1 is ON<br /> <img src="images/ble_setup.jpg" width="400" height="200" align="middle" /></li> </ul> <h4 id="programming-private-characteristics"> <a href="#programming-private-characteristics" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Programming private characteristics </h4> <ul> <li>Download the manual configuration tool from <a href="https://www.microchip.com/wwwproducts/en/BM71">BM70/71 Firmware &amp; Software Tools v1.11</a></li> <li>Extract and locate configuration tool from below location - Your_downloaded_folder <code class="language-plaintext highlighter-rouge">\Firmware &amp; Software Tools v1.11\ConfigurationTool\IS187x_102_BLEDK3v1.11_UI1.00</code></li> <li>Double click on <code class="language-plaintext highlighter-rouge">IS187x_102_BLEDK3v1.11_UI1.00.exe</code></li> <li>Click on “Load” button and select “Load Text File”<br /> <img src="images/ble_config_loading_mainscreen.png" width="300" height="300" align="middle" /> <img src="images/ble_config_loading_step1.png" width="300" height="300" align="middle" /></li> <li>Select “<strong>bm71_environmental_private_service.txt</strong>” from <strong>bm71_configuration</strong> folder present in <strong>firmware</strong> folder<br /> <img src="images/ble_config_loading_step2.png" width="800" height="100" align="middle" /></li> <li> <p>Click on “EDIT” option<br /> <img src="images/ble_config_loading_step3.png" width="300" height="300" align="middle" /></p> </li> <li> <p>Select “0x01: BM71” in BLEDK and click ok</p> <p><img src="images/ble_config_loading_step4.png" width="400" height="200" align="middle" /></p> </li> <li> <p>Click on “Finish”<br /> <img src="images/ble_config_loading_step5.png" align="middle" /></p> </li> <li> <p>Click on “Write”<br /> <img src="images/ble_config_loading_step6.png" width="300" height="300" align="middle" /></p> </li> <li> <p>Select respective COM Port and set baud rate to 115200 then click on Write<br /> <img src="images/ble_config_loading_step7.png" width="300" height="250" align="middle" /></p> </li> <li> <p>Click on Yes to successfully update the private characteristics on to BM71 module.<br /> <img src="images/ble_config_loading_step8.png" width="300" height="200" align="middle" /></p> </li> <li> <p>After successful update, click ok and remove the power from BM71-XPRO and change jumper J2 to select EXT<br /> <img src="images/ble_config_loading_step9.png" width="300" height="300" align="middle" /></p> </li> <li>Turn OFF DIP 1 switch</li> </ul> <h2 id="setup"> <a href="#setup" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Setup: </h2> <ul> <li>Mount SAM D21 Curiosity Nano Evaluation Kit on “CNANO56_HOST_CONN”(U3) connector of Curiosity Nano Base board</li> <li>Mount Weather click board on mikro bus click 1 connector of Curiosity Nano Base board</li> <li>Mount the 10DOF Click on the mikro bus 2 connector of Curiosity Nano Base board</li> <li>Connect the BM71-XPRO on to EXT 1 connector of Curiosity Nano Base board</li> <li>Power the SAM D21 Curiosity Nano Evaluation Kit from a Host PC through a Type-A male to Micro-B USB cable connected to Micro-B port (J105)<br /> <img src="images/ble_app_demo_setup.jpg" width="600" height="500" align="middle" /></li> </ul> <h2 id="programming-hex-file"> <a href="#programming-hex-file" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Programming hex file: </h2> <p>The pre-built hex file can be programmed by following the below steps.</p> <h3 id="steps-to-program-the-hex-file"> <a href="#steps-to-program-the-hex-file" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Steps to program the hex file </h3> <p><span style="color:blue"> <em>Before proceeding with this step complete “Adding private characteristics to BM71” step.</em> </span></p> <ul> <li>Open MPLAB X IDE</li> <li>Close all existing projects in IDE, if any project is opened.</li> <li>Go to File -&gt; Import -&gt; Hex/ELF File</li> <li>In the “Import Image File” window, Step 1 - Create Prebuilt Project, Click the “Browse” button to select the prebuilt hex file.</li> <li>Select Device has “ATSAMD21G17D”</li> <li>Ensure the proper tool is selected under “Hardware Tool”</li> <li>Click on Next button</li> <li>In the “Import Image File” window, Step 2 - Select Project Name and Folder, select appropriate project name and folder</li> <li>Click on Finish button</li> <li>In MPLAB X IDE, click on “Make and Program Device” Button. The device gets programmed in sometime</li> <li>Follow the steps in “Running the Demo” section below</li> </ul> <h2 id="programmingdebugging-application-project"> <a href="#programmingdebugging-application-project" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Programming/Debugging Application Project: </h2> <p><span style="color:blue"> <em>Before proceeding with this step complete “Adding private characteristics to BM71” step.</em> </span></p> <ul> <li>Open the project (ble_weather_station\firmware\sam_d21_cnano.X) in MPLAB X IDE</li> <li>Ensure “PKOB nano” is selected as hardware tool to program/debug the application</li> <li>Build the code and program the device by clicking on the “make and program” button in MPLAB X IDE tool bar</li> <li>Follow the steps in “Running the Demo” section below</li> </ul> <h2 id="running-the-demo"> <a href="#running-the-demo" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Running the Demo: </h2> <p><span style="color:blue"> <em>Before proceeding install Microchip Bluetooth Data android app in an Android Smartphone.</em> </span></p> <ul> <li>Enable Bluetooth and location from Smatphone settings</li> <li>Perform reset by unplugging and re-plugging the power cable of SAM D21 Curiosity Nano</li> <li> <p>After power up, open “<strong>Microchip Bluetooth Data (MBD)</strong>” android app from your smartphone and tap on “BLE Sensor Node” icon on the dashboard. If prompted, allow the application to turn on Bluetooth.<br /> <img src="images/mbd_appscreen1.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Scan for Bluetooth devices by tapping START SCAN option. The BM71 device should appear as MCHP in the list of Bluetooth devices.<br /> <img src="images/mbd_appscreen14.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Stop the scan and connect using the <strong>MCHP BLE device</strong>. This will establish a connection between the MBD BLE application and the BM71 BLE device.<br /> <img src="images/mbd_appscreen2.png" width="250" height="450" align="middle" /> <img src="images/mbd_appscreen3.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Once connected, the application shows the proximity screen and displays the Status of the Bluetooth link and using RSSI, the approximate range between the Android device and the SAM D21 Curiosity Nano Evaluation Kit<br /> <img src="images/mbd_appscreen4.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Navigate to the Environment Sensor screen by swiping left on the proximity screen as shown in above figure<br /> <img src="images/mbd_appscreen5.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Tap on the Graph button next to the Temperature, Humidity and Pressure to see the PTH values plotted on graphs<br /> <img src="images/mbd_appscreen6.png" width="250" height="450" align="middle" /><br /> <img src="images/mbd_appscreen7.png" width="250" height="450" align="middle" /><br /> <img src="images/mbd_appscreen8.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Navigate to the Accelerometer Sensor screen by swiping twice on to left from Environment screen<br /> <img src="images/mbd_appscreen9.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Click on start button to see the Accelerometer values plotted on graph<br /> <img src="images/mbd_appscreen10.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Navigate to the Gyroscope Sensor screen by swiping left on the Accelerometer screen<br /> <img src="images/mbd_appscreen11.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Click on start button to see the Gyroscope values plotted on graph<br /> <img src="images/mbd_appscreen12.png" width="250" height="450" align="middle" /></p> </li> <li> <p>Navigate to the 3D Plot screen by swiping left on the Gyroscope screen<br /> <img src="images/mbd_appscreen13.png" width="250" height="450" align="middle" /></p> </li> <li>Keep finger on weather click board to see PTH values changing and move the 10DOF click board to see accelerometer and gyroscope values changing.</li> </ul> <h2 id="comments"> <a href="#comments" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Comments: </h2> <ul> <li>Other features on the application like the Step Count and Light are not supported by this demo. Navigating to these screens may lead to an undefined behavior.</li> <li>Code related for custom private services are added manually, harmony v3 framework doesn’t generate code related to it.</li> <li>Reference Training Module: <a href="https://microchipdeveloper.com/harmony3:samd21-getting-started-training-module">Getting Started with Harmony v3 Peripheral Libraries on SAM D21 MCUs</a></li> <li>This application demo builds and works out of box by following the instructions above in “Running the Demo” section. If you need to enhance/customize this application demo, you need to use the MPLAB Harmony v3 Software framework. Refer links below to setup and build your applications using MPLAB Harmony. <ul> <li><a href="https://www.microchip.com/mymicrochip/filehandler.aspx?ddocname=en1000821">How to Setup MPLAB Harmony v3 Software Development Framework</a></li> <li><a href="http://ww1.microchip.com/downloads/en/DeviceDoc/How_to_Build_Application_Adding_PLIB_%20Driver_or_Middleware%20_to_MPLAB_Harmony_v3Project_DS90003253A.pdf">How to Build an Application by Adding a New PLIB, Driver, or Middleware to an Existing MPLAB Harmony v3 Project</a></li> </ul> </li> </ul> <h3 id="revision"> <a href="#revision" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Revision: </h3> <ul> <li>v1.0 released demo application</li> </ul> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0"><img src='../../../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2020 Microchip Technology.</p> </footer> </div> </div> </div> </div> </body> </html>
